# TotalScript Standard Library Showcase
# Demonstrates all available stdlib modules

import math
import json
import fs
import time
import os

println("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
println("â•‘  TotalScript Standard Library Showcase   â•‘")
println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
println()

# ============================================================================
# MATH MODULE - Mathematical functions and constants
# ============================================================================
println("ğŸ“ MATH MODULE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

println("Constants:")
println("  Ï€ (PI)  =", math.PI)
println("  e (E)   =", math.E)
println()

println("Basic operations:")
println("  |âˆ’10|          =", math.abs(-10))
println("  min(5,2,8)     =", math.min(5, 2, 8))
println("  max(5,2,8)     =", math.max(5, 2, 8))
println("  âŒŠ3.7âŒ‹         =", math.floor(3.7))
println("  âŒˆ3.2âŒ‰         =", math.ceil(3.2))
println("  round(3.5)     =", math.round(3.5))
println()

println("Advanced math:")
println("  âˆš16            =", math.sqrt(16))
println("  2Â¹â°            =", math.pow(2, 10))
println("  sin(Ï€/2)       =", math.sin(math.PI / 2))
println("  cos(0)         =", math.cos(0))
println("  log(e)         =", math.log(math.E))
println("  logâ‚â‚€(100)     =", math.log10(100))
println()

# ============================================================================
# JSON MODULE - Parse and stringify JSON
# ============================================================================
println("ğŸ“„ JSON MODULE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

var user = {
    "name": "Alice",
    "age": 30,
    "skills": ["Go", "TotalScript", "JSON"],
    "active": true
}

var jsonStr = json.stringify(user)
println("Stringified:", jsonStr)

var parsed = json.parse(jsonStr)
println("Parsed back:", parsed["name"], "is", parsed["age"], "years old")
println("Skills:", parsed["skills"])
println()

# ============================================================================
# FS MODULE - File system operations
# ============================================================================
println("ğŸ“ FS MODULE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

# Create a sample data file
var sampleData = {
    "timestamp": time.now(),
    "message": "Hello from TotalScript!",
    "version": "1.0"
}

fs.writeFile("./sample_data.json", json.stringify(sampleData))
println("âœ“ Created sample_data.json")

if fs.exists("./sample_data.json") {
    println("âœ“ File exists")

    var content = fs.readFile("./sample_data.json")
    var data = json.parse(content)
    println("âœ“ Read data:", data["message"])
}

var files = fs.listDir(".")
println("âœ“ Current directory has", files.length(), "entries")
println()

# ============================================================================
# TIME MODULE - Time operations
# ============================================================================
println("â° TIME MODULE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

var start = time.now()
println("Current timestamp:", start, "ms")

println("Sleeping for 50ms...")
time.sleep(50)

var end = time.now()
println("After sleep:", end, "ms")
println("Elapsed:", end - start, "ms")
println()

# ============================================================================
# OS MODULE - Operating system utilities
# ============================================================================
println("ğŸ’» OS MODULE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")

var homeVar = os.env("HOME")
if homeVar is null {
    println("HOME not set")
} else {
    println("HOME:", homeVar)
}

var cmdArgs = os.args()
println("Script arguments:", cmdArgs)
println()

# ============================================================================
# PRACTICAL EXAMPLE - Combining modules
# ============================================================================
println("ğŸ”§ PRACTICAL EXAMPLE")
println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
println("Building a simple analytics logger...")
println()

const LogEntry = model {
    timestamp: integer
    event: string
    data: map<string, integer | string>
}

var events = []

# Simulate some events
for i in 0..3 {
    var entry = {
        "timestamp": time.now(),
        "event": "user_action",
        "data": {"action": "click", "count": i}
    }
    events.push(entry)
    time.sleep(10)
}

# Save to file
var logData = {"events": events, "total": events.length()}
fs.writeFile("./analytics.json", json.stringify(logData))
println("âœ“ Saved", events.length(), "events to analytics.json")

# Read and analyze
if fs.exists("./analytics.json") {
    var logContent = fs.readFile("./analytics.json")
    var analytics = json.parse(logContent)
    println("âœ“ Analytics file contains", analytics["total"], "events")

    var firstEvent = analytics["events"][0]
    var lastEvent = analytics["events"][analytics["events"].length() - 1]
    var duration = lastEvent["timestamp"] - firstEvent["timestamp"]

    println("âœ“ Events captured over", duration, "ms")
}

println()
println("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
println("â•‘           Showcase Complete!              â•‘")
println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
